import os
from openpyxl import load_workbook

def get_input_from_excel(input_keyword, sheet_name):
    try:
        script_dir = os.path.dirname(os.path.abspath(__file__))
        parent_dir = os.path.dirname(script_dir)
        folder_name = os.path.join(parent_dir, "resources", "data_file")
        input_file = os.path.join(folder_name, "data.xlsx")

        wb = load_workbook(input_file)

        if sheet_name not in wb.sheetnames:
            print(f"Sheet '{sheet_name}' not found in workbook.")
            return None

        ws = wb[sheet_name]

        data = {}
        for col in ws.iter_cols(min_row=1, max_row=2, values_only=True):
            key = col[0]
            value = col[1]
            if key and value:
                data[key] = value

        print("Extracted values:", data)

        if input_keyword in data:
            return data[input_keyword]
        else:
            print(f"Keyword '{input_keyword}' not found.")
            return None

    except Exception as e:
        print(f"An error occurred: {e}")
        return None
